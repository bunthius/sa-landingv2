<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Atlas - Explore, Conquer, and Earn in a real cash economy.</title>
    <link rel="icon" type="image/png" href="Icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Bar -->
    <div class="loading-bar" id="loadingBar"></div>
    
    <!-- Grid Background -->
    <div class="grid-container">
        <div class="grid-layer dots"></div>
        <div class="grid-layer grid"></div>
        <div class="grid-layer accent"></div>
    </div>
    
    <!-- Mouse spotlight effect -->
    <div class="mouse-spotlight"></div>
    
    <!-- Glow Effects -->
    <div class="glow-container">
        <div class="glow"></div>
        <div class="glow"></div>
        <div class="glow"></div>
    </div>
    


    <!-- Navigation -->
    <nav class="gated-content" style="display: none;">

        <div class="nav-main">
            <div class="nav-container">
                <div class="logo">
                    <img src="Logo.svg" alt="Star Atlas">
                </div>
                <ul class="nav-links">
                    <li class="has-dropdown">
                        <a href="#game">Game</a>
                        <ul class="dropdown-menu">
                            <li><a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank">Star Atlas</a></li>
                            <li><a href="https://based.staratlas.com/" target="_blank">SAGE Labs</a></li>
                            <li><a href="https://holosim.staratlas.com/" target="_blank">Holosim</a></li>
                        </ul>
                    </li>
                    <li><a href="https://staratlas.com/experience" target="_blank">Experience</a></li>
                    <li><a href="https://staratlas.com/newsroom" target="_blank">News & Info</a></li>
                    <li><a href="https://staratlas.com/contact" target="_blank">Contact</a></li>
                </ul>
                <div class="nav-cta">
                    <a href="https://play.staratlas.com/market/" target="_blank" class="download-btn"><span>Galactic Marketplace</span></a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <!-- Video Background -->
        <video class="video-background" autoplay muted loop playsinline>
            <source src="src/herosection_loop_7-21-hb3.mp4" type="video/mp4">
        </video>
        <div class="video-overlay"></div>
        
        <div class="hero-content center-bottom" id="heroContent">
            <div class="hero-tagline">
                <span>EXPLORE, CONQUER, AND EARN</span>
                <span>IN A REAL CASH ECONOMY</span>
            </div>
            <img src="Logo.svg" alt="Star Atlas" class="hero-logo">
            <div class="hero-cta">
                <div class="terminal-box">
                    <div class="terminal-box-corners"></div>
                    <div class="terminal-header">
                        <div class="terminal-icon-box">
                            <img src="Icon.svg" alt="Star Atlas" class="terminal-icon">
                        </div>
                        <span class="terminal-title">EARLY ACCESS</span>
                        <button class="terminal-close" onclick="bypassEmailGate(event)" aria-label="Close">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 1L1 13M1 1L13 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="terminal-body">
                        <p class="terminal-description">Enter your Email for a Star Atlas Early Access Key<br>& one copy of The Star Atlas Guide to Everything!</p>
                        <form class="early-access-form" onsubmit="submitEarlyAccessInline(event)">
                            <div class="email-input-wrapper">
                                <input 
                                    type="email" 
                                    id="heroEmailInput" 
                                    placeholder="Email Address" 
                                    required
                                    class="hero-email-input"
                                    oninput="updateEmailDisplay(this)"
                                />
                                <div class="email-display" id="emailDisplay"></div>
                            </div>
                            <div class="button-wrapper">
                                <div class="corner-bracket top-left"></div>
                                <div class="corner-bracket top-right"></div>
                                <div class="corner-bracket bottom-left"></div>
                                <div class="corner-bracket bottom-right"></div>
                                <button type="submit" class="hero-submit-btn"><span>GET EARLY ACCESS NOW</span></button>
                            </div>
                        </form>
                    </div>
                    <div class="terminal-footer">
                        <div class="star-atlas-log" id="starAtlasLog">
                            <span class="log-date">2625.07.22</span>
                            <span class="log-time">00:00:00</span>
                        </div>
                    </div>
                    <div class="bottom-corners"></div>
                </div>
                <div id="heroMessage" class="hero-message" style="display: none;"></div>
            </div>
        </div>
    </section>





    <!-- Gated Content Container -->
    <div id="gatedContent" class="gated-sections" style="display: none;">
    
    <!-- Game Section -->
    <section class="game-section" id="game">
        <div class="section-corners"></div>
        <div class="section-header">
            <div style="display: flex; align-items: stretch;">
                <span class="section-number">0001.</span>
                <h2 class="section-title">GAME</h2>
            </div>
            <div class="section-icon-wrapper">
                <img src="Icon.svg" alt="" class="section-icon" onclick="window.scrollTo({ top: 0, behavior: 'smooth' })">
                <span class="section-tooltip">TO THE TOP</span>
            </div>
        </div>
        <p class="section-subtitle">Immerse yourself in the vastness of Galia, where Star Atlas comes alive.</p>
        
        <div class="toggle-container">
            <button class="toggle-btn active" onclick="showGameMode('3rdperson')">3rd Person Experience</button>
            <button class="toggle-btn" onclick="showGameMode('rts')">Top-Down RTS View</button>
        </div>

        <!-- 3rd Person Content -->
        <div id="3rdperson" class="game-content active">
            <p style="text-align: center; color: rgba(255, 255, 255, 1); max-width: 800px; margin: 0 auto 3rem;">
                Join the fight for resources and territory with intense ship-to-ship and FPS combat, exploration, 
                crafting, and quests.
            </p>
            
            <!-- Video Carousel -->
            <div class="video-carousel">
                <div class="carousel-container">
                    <div class="carousel-track" id="carousel-3rd">
                        <!-- Slide 1: Galia -->
                        <div class="carousel-slide active">
                            <video class="carousel-video" poster="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_1_ImageThumbnail.png" autoplay muted>
                                <source src="src/GAME section/3rd Person Experience/Slide_1_Galia.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Galia</h3>
                                <p class="slide-description">Explore the unexplored. Take on unknown dangers. Build a galactic empire.</p>
                                <a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                        
                        <!-- Slide 2: Game Modes -->
                        <div class="carousel-slide">
                            <video class="carousel-video" poster="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_2_ImageThumbnail.png" muted>
                                <source src="src/GAME section/3rd Person Experience/Slide_2_GameModes.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Game Modes</h3>
                                <p class="slide-description">Conquer Galia, then crush the competition. Shooter arena battles, racing tracks, PVE dogfights and more await.</p>
                                <a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                        
                        <!-- Slide 3: Your Fleet Your Way -->
                        <div class="carousel-slide">
                            <video class="carousel-video" poster="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_3_ImageThumbnail.png" muted>
                                <source src="src/GAME section/3rd Person Experience/Slide_3_YourFleetYourWay.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Your Fleet, Your Way</h3>
                                <p class="slide-description">View, build, and customize your fleet. Whether you're exploring the detailed interiors of your ships or managing your entire armada, it's all under your command.</p>
                                <a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                        
                        <!-- Slide 4: Life in Galia -->
                        <div class="carousel-slide">
                            <video class="carousel-video" poster="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_4_ImageThumbnail.png" muted>
                                <source src="src/GAME section/3rd Person Experience/Slide_4_LifeinGalia.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Life in Galia</h3>
                                <p class="slide-description">From the small, furred Punaabs to luminous beings of pure light, Galia teems with diverse life.</p>
                                <a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Carousel Navigation -->
                    <button class="carousel-btn carousel-prev" onclick="changeSlide('3rd', -1)">‹</button>
                    <button class="carousel-btn carousel-next" onclick="changeSlide('3rd', 1)">›</button>
                    
                    <!-- Carousel Indicators -->
                    <div class="carousel-indicators">
                        <span class="indicator active" onclick="goToSlide('3rd', 0)"></span>
                        <span class="indicator" onclick="goToSlide('3rd', 1)"></span>
                        <span class="indicator" onclick="goToSlide('3rd', 2)"></span>
                        <span class="indicator" onclick="goToSlide('3rd', 3)"></span>
                    </div>
                </div>
                
                <!-- Thumbnail Carousel -->
                <div class="thumbnail-carousel">
                    <div class="thumbnail-item active" onclick="goToSlide('3rd', 0)">
                        <img src="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_1_ImageThumbnail.png" alt="Galia">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide('3rd', 1)">
                        <img src="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_2_ImageThumbnail.png" alt="Game Modes">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide('3rd', 2)">
                        <img src="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_3_ImageThumbnail.png" alt="Your Fleet, Your Way">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide('3rd', 3)">
                        <img src="src/GAME section/3rd Person Experience/Thumbnails in carousel/Slide_4_ImageThumbnail.png" alt="Life in Galia">
                    </div>
                </div>
            </div>
        </div>

        <!-- RTS Content -->
        <div id="rts" class="game-content">
            <p style="text-align: center; color: rgba(255, 255, 255, 1); max-width: 800px; margin: 0 auto 3rem;">
                Command vast fleets from a strategic overhead view. Manage resources, territories, and 
                shape the political landscape of the galaxy.
            </p>
            
            <!-- Video Carousel -->
            <div class="video-carousel">
                <div class="carousel-container">
                    <div class="carousel-track" id="carousel-rts">
                        <!-- Slide 1: Fleet Command -->
                        <div class="carousel-slide active">
                            <video class="carousel-video" poster="src/GAME section/Top-down RTS View/Thumbnail Images/RTS_Slide_1_ImageThumbnail.png" autoplay muted>
                                <source src="src/GAME section/Top-down RTS View/TDS_Slide_1_FleetCommand.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Fleet Command</h3>
                                <p class="slide-description">With the press of a button, switch from a third-person experience to a top-down view where you can mass-manage your fleets, dominate Galia and outmaneuver opposing factions. Coming soon.</p>
                                <a href="https://store.epicgames.com/en-US/p/star-atlas-bead34" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                        
                        <!-- Slide 2: Holosim -->
                        <div class="carousel-slide">
                            <video class="carousel-video" poster="src/GAME section/Top-down RTS View/Thumbnail Images/Slide_1_Holosim_Thumbnail.png" muted>
                                <source src="src/GAME section/Top-down RTS View/Slide_2_Holosim.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">Holosim</h3>
                                <p class="slide-description">Holosim brings the heart of Fleet Command to your browser. It's a free-to-play in-universe simulation that lets you manage your fleets and experience strategic gameplay instantly, all without needing high-end hardware, ships, or a crypto wallet.</p>
                                <a href="https://holosim.staratlas.com/" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                        
                        <!-- Slide 3: SAGE Labs -->
                        <div class="carousel-slide">
                            <video class="carousel-video" poster="src/GAME section/Top-down RTS View/Thumbnail Images/RTS_Slide_1_ImageThumbnail.png" muted>
                                <source src="src/GAME section/Top-down RTS View/TDS_Slide_1_FleetCommand.mp4" type="video/mp4">
                            </video>
                            <div class="slide-caption">
                                <h3 class="slide-title">SAGE Labs</h3>
                                <p class="slide-description">SAGE Labs brings the Star Atlas economy to life right in your browser. Manage your fleet, mine resources, craft items, and scan for SDUs. You're not hunting for gold; you're supplying the shovels.</p>
                                <a href="https://based.staratlas.com/" target="_blank" class="slide-link">Play Now</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Carousel Navigation -->
                    <button class="carousel-btn carousel-prev" onclick="changeSlide('rts', -1)">‹</button>
                    <button class="carousel-btn carousel-next" onclick="changeSlide('rts', 1)">›</button>
                    
                    <!-- Carousel Indicators -->
                    <div class="carousel-indicators">
                        <span class="indicator active" onclick="goToSlide('rts', 0)"></span>
                        <span class="indicator" onclick="goToSlide('rts', 1)"></span>
                        <span class="indicator" onclick="goToSlide('rts', 2)"></span>
                    </div>
                </div>
                
                <!-- Thumbnail Carousel -->
                <div class="thumbnail-carousel">
                    <div class="thumbnail-item active" onclick="goToSlide('rts', 0)">
                        <img src="src/GAME section/Top-down RTS View/Thumbnail Images/RTS_Slide_1_ImageThumbnail.png" alt="Fleet Command">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide('rts', 1)">
                        <img src="src/GAME section/Top-down RTS View/Thumbnail Images/Slide_1_Holosim_Thumbnail.png" alt="Holosim">
                    </div>
                    <div class="thumbnail-item" onclick="goToSlide('rts', 2)">
                        <img src="src/GAME section/Top-down RTS View/Thumbnail Images/RTS_Slide_1_ImageThumbnail.png" alt="SAGE Labs">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Economy Section -->
    <section class="economy-section" id="economy">
        <div class="section-header">
            <div style="display: flex; align-items: stretch;">
                <span class="section-number">0002.</span>
                <h2 class="section-title">Economy</h2>
            </div>
            <div class="section-icon-wrapper">
                <img src="Icon.svg" alt="" class="section-icon" onclick="window.scrollTo({ top: 0, behavior: 'smooth' })">
                <span class="section-tooltip">TO THE MOON</span>
            </div>
        </div>
        <p class="section-subtitle">Join a real cash economy with real opportunities.</p>
        
        <div class="stats-grid">
            <div class="stat-card">
                <pixel-canvas data-gap="6" data-speed="20" data-colors="#32feff,#ffffff" data-variant="icon" data-opacity="0.85"></pixel-canvas>
                <div class="stat-content">
                    <div class="stat-value">$68.3M</div>
                    <div class="stat-label">Total Volume Traded</div>
                </div>
            </div>
            
            <div class="stat-card">
                <pixel-canvas data-gap="6" data-speed="20" data-colors="#32feff,#ffffff" data-variant="icon" data-opacity="0.85"></pixel-canvas>
                <div class="stat-content">
                    <div class="stat-value">$21.1M</div>
                    <div class="stat-label">Annual GDP</div>
                </div>
            </div>
            
            <div class="stat-card">
                <pixel-canvas data-gap="6" data-speed="20" data-colors="#32feff,#ffffff" data-variant="icon" data-opacity="0.85"></pixel-canvas>
                <div class="stat-content">
                    <div class="stat-value">9.69M</div>
                    <div class="stat-label">Average ATLAS Earned Daily</div>
                </div>
            </div>
        </div>
        
        <div class="economy-cta">
            <a href="https://staratlas.com/newsroom/economic-reports" target="_blank" class="secondary-btn">Latest Economic Report</a>
            <a href="https://play.staratlas.com/market/" target="_blank" class="secondary-btn">Explore Galactic Marketplace</a>
        </div>
    </section>

    <!-- Community Section -->
    <section class="community-section" id="community">
        <div class="section-header">
            <div style="display: flex; align-items: stretch;">
                <span class="section-number">0003.</span>
                <h2 class="section-title">Community</h2>
            </div>
            <div class="section-icon-wrapper">
                <img src="Icon.svg" alt="" class="section-icon" onclick="window.scrollTo({ top: 0, behavior: 'smooth' })">
                <span class="section-tooltip">TO THE TOP</span>
            </div>
        </div>
        
        <div class="community-hero">
            <div class="community-content-wrapper">
                
                <div class="community-visual-content">
                    <div class="community-characters">
                        <img src="src/community/left-char.png" alt="Character" class="community-char char-left">
                        <img src="src/community/mid-char.png" alt="Character" class="community-char char-mid">
                        <img src="src/community/right-char.png" alt="Character" class="community-char char-right">
                    </div>
                    
                    <a href="https://discord.gg/staratlas" target="_blank" class="discord-card-link">
                        <div class="discord-card">
                            <div class="discord-card-content">
                                <div class="discord-card-image">
                                    <img src="src/community/discord-bg.jpg" alt="Star Atlas Discord">
                                    <!-- <pixel-canvas data-gap="20" data-speed="15" data-colors="#5affff" data-variant="icon" data-opacity="1" data-blend="additive" data-size="2"></pixel-canvas> -->
                                    <div class="card-logos">
                                        <img src="Icon.svg" alt="Star Atlas" class="star-atlas-logo">
                                        <svg class="discord-logo" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/>
                                        </svg>
                                    </div>
                                </div>
                                <div class="slide-caption discord-card-text">
                                    <h4 class="slide-title">STAR ATLAS DISCORD</h4>
                                    <p class="slide-description">Join a community of pioneers, ready to answer all of your questions.</p>
                                    <span class="discord-cta">discord.gg/staratlas</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <div class="footer-column">
                    <h4>Community</h4>
                    <ul>
                        <li><a href="https://x.com/staratlas" target="_blank">X</a></li>
                        <li><a href="https://discord.gg/StarAtlas" target="_blank">Discord</a></li>
                        <li><a href="https://www.youtube.com/channel/UCt-y8Npwje5KDG5MSZ0a9Jw" target="_blank">YouTube</a></li>
                        <li><a href="https://www.reddit.com/r/StarAtlas/" target="_blank">Reddit</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="https://support.staratlas.com/" target="_blank">Help Center</a></li>
                        <li><a href="https://staratlas.com/contact" target="_blank">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="https://staratlas.com/careers" target="_blank">Careers</a></li>
                        <li><a href="https://staratlas.com/newsroom/press-kit" target="_blank">Press</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p class="footer-text">© 2625 Star Atlas. All rights reserved. | <a href="https://staratlas.com/terms-of-service" target="_blank">Terms of Service</a> | <a href="https://staratlas.com/privacy-policy" target="_blank">Privacy Policy</a></p>
            </div>
        </div>
    </footer>
    
    </div> <!-- End of Gated Content -->

    <!-- Scan Line Effect -->
    <div class="scan-line"></div>

    <!-- Sticky Footer Bar -->
    <div class="sticky-footer-bar" id="stickyFooterBar">
        <div class="footer-bar-container">
            <div class="footer-bar-icon-box">
                <img src="Icon.svg" alt="Star Atlas" class="footer-bar-icon">
            </div>
            <div class="footer-bar-title">EARLY ACCESS</div>
            <div class="footer-bar-center">
                <form class="footer-email-form" onsubmit="submitFooterEmail(event)">
                    <div class="footer-email-wrapper">
                        <input type="email" class="footer-email-input" placeholder="Add email for early access" required>
                        <div class="footer-email-display">
                            <span class="footer-email-local"></span><span class="footer-email-domain"></span>
                        </div>
                    </div>
                    <button type="submit" class="footer-submit-btn">GET ACCESS NOW</button>
                </form>
            </div>
            <div class="footer-timestamp">
                <span class="footer-log-prefix">STAR.ATLAS LOG</span>
                <span class="footer-timestamp-date" id="footer-timestamp-date">00/00/0000</span>
                <span class="footer-timestamp-time" id="footer-timestamp-time">00:00:00</span>
            </div>
            <button class="footer-bar-close" onclick="closeFooterBar()">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13 1L1 13M1 1L13 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // Toggle game content
        function showGameMode(mode) {
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.game-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(mode).classList.add('active');
            
            // Stop all auto-play timers
            stopAutoPlay('3rd');
            stopAutoPlay('rts');
            
            // Start auto-play for the new active carousel
            if (mode === '3rd-person') {
                startAutoPlay('3rd');
            } else if (mode === 'rts-view') {
                startAutoPlay('rts');
            }
        }

        // Video Carousel Functions
        const carousels = {
            '3rd': { currentSlide: 0, totalSlides: 4, interval: null },
            'rts': { currentSlide: 0, totalSlides: 3, interval: null }
        };

        function changeSlide(carouselId, direction) {
            const carousel = carousels[carouselId];
            const track = document.getElementById(`carousel-${carouselId}`);
            const slides = track.querySelectorAll('.carousel-slide');
            const indicators = track.parentElement.querySelectorAll('.indicator');
            const thumbnails = track.parentElement.parentElement.querySelectorAll('.thumbnail-item');
            
            // Hide current slide and stop video
            slides[carousel.currentSlide].classList.remove('active');
            const currentVideo = slides[carousel.currentSlide].querySelector('video');
            if (currentVideo) {
                currentVideo.pause();
                currentVideo.currentTime = 0;
            }
            if (thumbnails[carousel.currentSlide]) {
                thumbnails[carousel.currentSlide].classList.remove('active');
            }
            
            // Calculate new slide index
            carousel.currentSlide += direction;
            if (carousel.currentSlide >= carousel.totalSlides) {
                carousel.currentSlide = 0;
            } else if (carousel.currentSlide < 0) {
                carousel.currentSlide = carousel.totalSlides - 1;
            }
            
            // Show new slide and play video
            slides[carousel.currentSlide].classList.add('active');
            const newVideo = slides[carousel.currentSlide].querySelector('video');
            if (newVideo) {
                // Ensure video has required attributes for mobile autoplay
                newVideo.setAttribute('muted', '');
                newVideo.setAttribute('playsinline', '');
                newVideo.setAttribute('webkit-playsinline', '');
                newVideo.play().catch(e => console.log('Video play failed:', e));
            }
            if (thumbnails[carousel.currentSlide]) {
                thumbnails[carousel.currentSlide].classList.add('active');
            }
        }

        function goToSlide(carouselId, slideIndex) {
            const carousel = carousels[carouselId];
            const track = document.getElementById(`carousel-${carouselId}`);
            const slides = track.querySelectorAll('.carousel-slide');
            const thumbnails = track.parentElement.parentElement.querySelectorAll('.thumbnail-item');
            
            // Hide current slide and stop video
            slides[carousel.currentSlide].classList.remove('active');
            const currentVideo = slides[carousel.currentSlide].querySelector('video');
            if (currentVideo) {
                currentVideo.pause();
                currentVideo.currentTime = 0;
            }
            if (thumbnails[carousel.currentSlide]) {
                thumbnails[carousel.currentSlide].classList.remove('active');
            }
            
            // Show new slide and play video
            carousel.currentSlide = slideIndex;
            slides[carousel.currentSlide].classList.add('active');
            const newVideo = slides[carousel.currentSlide].querySelector('video');
            if (newVideo) {
                // Ensure video has required attributes for mobile autoplay
                newVideo.setAttribute('muted', '');
                newVideo.setAttribute('playsinline', '');
                newVideo.setAttribute('webkit-playsinline', '');
                newVideo.play().catch(e => console.log('Video play failed:', e));
            }
            if (thumbnails[carousel.currentSlide]) {
                thumbnails[carousel.currentSlide].classList.add('active');
            }
            
            // Reset auto-play timer
            if (carousel.interval) {
                clearInterval(carousel.interval);
                startAutoPlay(carouselId);
            }
        }

        // Auto-play functionality
        function startAutoPlay(carouselId) {
            const carousel = carousels[carouselId];
            // Clear any existing interval
            if (carousel.interval) {
                clearInterval(carousel.interval);
            }
            // Set a backup timer in case video doesn't end (e.g., loading issues)
            carousel.interval = setInterval(() => {
                changeSlide(carouselId, 1);
            }, 30000); // Fallback: change slide every 30 seconds
        }

        function stopAutoPlay(carouselId) {
            const carousel = carousels[carouselId];
            if (carousel.interval) {
                clearInterval(carousel.interval);
                carousel.interval = null;
            }
        }

        // Setup video end listeners
        function setupVideoEndListeners(carouselId) {
            const track = document.getElementById(`carousel-${carouselId}`);
            const videos = track.querySelectorAll('video');
            
            videos.forEach((video, index) => {
                video.addEventListener('ended', () => {
                    // Move to next slide when video ends
                    changeSlide(carouselId, 1);
                });
            });
        }

        // Initialize carousels when content becomes active
        document.addEventListener('DOMContentLoaded', function() {
            // Setup video end listeners for both carousels
            setupVideoEndListeners('3rd');
            setupVideoEndListeners('rts');
            
            // Start auto-play for the initially active carousel
            const activeContent = document.querySelector('.game-content.active');
            if (activeContent && activeContent.id === '3rd-person') {
                startAutoPlay('3rd');
            } else if (activeContent && activeContent.id === 'rts-view') {
                startAutoPlay('rts');
            }
            
            // Add playsinline attribute to all videos for mobile
            const allVideos = document.querySelectorAll('video');
            allVideos.forEach(video => {
                video.setAttribute('playsinline', '');
                video.setAttribute('webkit-playsinline', '');
                video.setAttribute('muted', '');
                
                // Keep autoplay enabled for all devices
                video.setAttribute('autoplay', '');
            });
            
            // Setup intersection observer to play videos when they come into view
            const videoObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const video = entry.target;
                    if (entry.isIntersecting && video.paused) {
                        // Play video when it comes into view
                        video.play().catch(e => console.log('Video autoplay failed:', e));
                    }
                });
            }, {
                threshold: 0.5 // Play when 50% of video is visible
            });
            
            // Observe all carousel videos
            document.querySelectorAll('.carousel-video').forEach(video => {
                videoObserver.observe(video);
            });
        });

        // Update timestamp every second with correct future date
        function updateTimestamp() {
            const now = new Date();
            const futureDate = new Date(now);
            futureDate.setFullYear(now.getFullYear() + 600);
            
            const time = futureDate.toLocaleTimeString('en-US', { hour12: false });
            const date = futureDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: '2-digit' 
            });
            
            // Update Star Atlas Log timestamp
            const starAtlasLog = document.getElementById('starAtlasLog');
            if (starAtlasLog) {
                const logDate = starAtlasLog.querySelector('.log-date');
                const logTime = starAtlasLog.querySelector('.log-time');
                
                if (logDate && logTime) {
                    // Format date as YYYY.MM.DD
                    const year = futureDate.getFullYear();
                    const month = String(futureDate.getMonth() + 1).padStart(2, '0');
                    const day = String(futureDate.getDate()).padStart(2, '0');
                    logDate.textContent = `${year}.${month}.${day}`;
                    
                    // Format time as HH:MM:SS
                    const hours = String(futureDate.getHours()).padStart(2, '0');
                    const minutes = String(futureDate.getMinutes()).padStart(2, '0');
                    const seconds = String(futureDate.getSeconds()).padStart(2, '0');
                    logTime.textContent = `${hours}:${minutes}:${seconds}`;
                }
            }
            
            // Update footer bar timestamp
            const footerTimeEl = document.getElementById('footer-timestamp-time');
            const footerDateEl = document.getElementById('footer-timestamp-date');
            if (footerTimeEl && footerDateEl) {
                // Format date as YYYY.MM.DD
                const year = futureDate.getFullYear();
                const month = String(futureDate.getMonth() + 1).padStart(2, '0');
                const day = String(futureDate.getDate()).padStart(2, '0');
                footerDateEl.textContent = `${year}.${month}.${day}`;
                
                // Format time as HH:MM:SS
                const hours = String(futureDate.getHours()).padStart(2, '0');
                const minutes = String(futureDate.getMinutes()).padStart(2, '0');
                const seconds = String(futureDate.getSeconds()).padStart(2, '0');
                footerTimeEl.textContent = `${hours}:${minutes}:${seconds}`;
            }
        }
        setInterval(updateTimestamp, 1000);
        updateTimestamp();

        // News filter
        document.querySelectorAll('.news-nav button').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.news-nav button').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Animate news cards on filter change
                document.querySelectorAll('.news-card').forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'scale(1)';
                    }, index * 100);
                });
            });
        });

        // Add active loading bar on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.querySelector('.loading-bar').classList.add('active');
            }, 100);

            setTimeout(() => {
                document.querySelector('.loading-bar').classList.remove('active');
            }, 2600);
        });

        // Enhanced scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    
                    // Animate stat bars
                    if (entry.target.classList.contains('stat-item')) {
                        const fill = entry.target.querySelector('.stat-fill');
                        if (fill) {
                            setTimeout(() => {
                                fill.style.width = fill.dataset.value + '%';
                            }, 200);
                        }
                    }
                    
                    // Animate counter numbers
                    if (entry.target.classList.contains('stat-card')) {
                        const value = entry.target.querySelector('.stat-value');
                        if (value && !value.classList.contains('animated')) {
                            value.classList.add('animated');
                            animateValue(value);
                        }
                    }
                }
            });
        }, observerOptions);

        // Observe elements
        document.querySelectorAll('.section-header, .stat-item, .stat-card, .feature-card, .news-card, .ship-showcase').forEach(el => {
            el.classList.add('scroll-reveal');
            observer.observe(el);
        });

        // Animate counter with easing
        function animateValue(element) {
            const endValue = element.textContent;
            const duration = 2500;
            const start = 0;
            const end = parseFloat(endValue.replace(/[^0-9.]/g, ''));
            const isDecimal = endValue.includes('.');
            const prefix = endValue.match(/[^0-9.]*/)[0];
            const suffix = endValue.match(/[^0-9.]*$/)[0];
            
            let startTimestamp = null;
            
            const easeOutQuad = t => t * (2 - t);
            
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easedProgress = easeOutQuad(progress);
                const currentValue = Math.floor(easedProgress * (end - start) + start);
                
                if (isDecimal) {
                    element.textContent = prefix + currentValue.toFixed(1) + suffix;
                } else {
                    element.textContent = prefix + currentValue.toLocaleString() + suffix;
                }
                
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                    element.textContent = endValue;
                }
            };
            
            window.requestAnimationFrame(step);
        }

        // Enhanced parallax effect
        let mouseX = 0;
        let mouseY = 0;
        let targetX = 0;
        let targetY = 0;

        document.addEventListener('mousemove', (e) => {
            mouseX = (e.clientX / window.innerWidth - 0.5) * 2;
            mouseY = (e.clientY / window.innerHeight - 0.5) * 2;
        });

        function updateParallax() {
            targetX += (mouseX - targetX) * 0.05;
            targetY += (mouseY - targetY) * 0.05;

            // Move glow effects
            document.querySelectorAll('.glow').forEach((glow, index) => {
                const speed = (index + 1) * 15;
                glow.style.transform = `translate(${targetX * speed}px, ${targetY * speed}px)`;
            });

            // Move hero content with subtle effect - DISABLED
            // const heroContent = document.querySelector('.hero-content');
            // if (heroContent) {
            //     heroContent.style.transform = `translate(${targetX * 5}px, ${targetY * 5}px)`;
            // }

            // Move grid layers
            const gridDots = document.querySelector('.grid-layer.dots');
            if (gridDots) {
                gridDots.style.transform = `translate(${targetX * 3}px, ${targetY * 3}px)`;
            }

            requestAnimationFrame(updateParallax);
        }
        updateParallax();

        // Smooth scroll with offset for fixed nav
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const offset = 100;
                    const targetPosition = target.offsetTop - offset;
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Enhanced scroll indicator on nav
        let lastScroll = 0;
        window.addEventListener('scroll', () => {
            const nav = document.querySelector('nav');
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }
            
            // Hide/show nav on scroll
            if (currentScroll > lastScroll && currentScroll > 300) {
                nav.style.transform = 'translateY(-100%)';
            } else {
                nav.style.transform = 'translateY(0)';
            }
            
            lastScroll = currentScroll;
        });



        // Add hover tilt effect to cards
        document.querySelectorAll('.feature-card, .news-card, .stat-card').forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const rotateX = (y - centerY) / 10;
                const rotateY = (centerX - x) / 10;
                
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(10px)`;
            });
            
            card.addEventListener('mouseleave', () => {
                card.style.transform = '';
            });
        });

        // Add typing effect to hero tagline - works with span structure
        const tagline = document.querySelector('.hero-tagline');
        if (tagline) {
            const spans = tagline.querySelectorAll('span');
            tagline.style.opacity = '1';
            
            // Store the original text for each span
            const originalTexts = Array.from(spans).map(span => span.textContent);
            
            // Clear all spans initially
            spans.forEach(span => span.textContent = '');
            
            // Type each span sequentially
            let currentSpan = 0;
            let currentChar = 0;
            
            const typeWriter = () => {
                if (currentSpan < spans.length) {
                    if (currentChar < originalTexts[currentSpan].length) {
                        spans[currentSpan].textContent += originalTexts[currentSpan].charAt(currentChar);
                        currentChar++;
                        setTimeout(typeWriter, 50);
                    } else {
                        // Move to next span
                        currentSpan++;
                        currentChar = 0;
                        setTimeout(typeWriter, 100); // Small pause between lines
                    }
                }
            };
            
            setTimeout(typeWriter, 1000);
        }

        // Initialize page with fade-in
        window.addEventListener('load', () => {
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 1s ease';
                document.body.style.opacity = '1';
            }, 100);
            
            // Start animations
            document.querySelectorAll('.stat-fill').forEach(fill => {
                fill.style.width = '0';
            });
        });

        // Add keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                // Close any open modals or reset UI
                document.querySelectorAll('.active').forEach(el => {
                    if (!el.classList.contains('game-content')) {
                        el.classList.remove('active');
                    }
                });
            }
        });

        // Performance optimization - throttle scroll events
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            if (scrollTimeout) {
                window.cancelAnimationFrame(scrollTimeout);
            }
            scrollTimeout = window.requestAnimationFrame(() => {
                // Update UI based on scroll
            });
        });

        // Early Access Functions
        async function submitEarlyAccessInline(e) {
            e.preventDefault();
            const email = document.getElementById('heroEmailInput').value;
            const submitBtn = e.target.querySelector('.hero-submit-btn');
            const messageDiv = document.getElementById('heroMessage');
            const form = document.querySelector('.early-access-form');
            const bypassLink = document.querySelector('.bypass-link');
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            messageDiv.style.display = 'none';
            
            // For local testing, always use mock response
            const isLocalhost = window.location.hostname === 'localhost' || 
                               window.location.hostname === '127.0.0.1' ||
                               window.location.hostname === '' ||
                               window.location.protocol === 'file:';
            
            if (isLocalhost || !navigator.onLine) {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Mock successful response
                const mockKey = 'TEST-KEY-' + Math.random().toString(36).substr(2, 9).toUpperCase();
                messageDiv.innerHTML = `
                    <div class="success-inline">
                        <p>Success! Your early access key: <strong>${mockKey}</strong></p>
                        <button onclick="copyAccessKeyInline('${mockKey}')" class="copy-btn-inline">Copy Key</button>
                    </div>
                `;
                messageDiv.className = 'hero-message success';
                messageDiv.style.display = 'block';
                
                // Hide form and bypass link
                form.style.display = 'none';
                if (bypassLink) bypassLink.style.display = 'none';
                
                // Display success toaster for 10 seconds
                // After 10 seconds, hide the toaster and simulate X button click
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                    
                    // Then simulate clicking the X button to close the terminal box
                    const closeButton = document.querySelector('.terminal-close');
                    if (closeButton) {
                        closeButton.click();
                    }
                }, 10000); // 10 seconds
                
                submitBtn.disabled = false;
                submitBtn.textContent = 'GET EARLY ACCESS NOW';
                return; // Exit early, no need for try/catch
            }
            
            try {
                const response = await fetch('/api/early-access', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    messageDiv.innerHTML = `
                        <div class="success-inline">
                            <p>Success! Your early access key: <strong>${data.key || 'STAR-ATLAS-KEY-XXXX'}</strong></p>
                            <button onclick="copyAccessKeyInline('${data.key || 'STAR-ATLAS-KEY-XXXX'}')" class="copy-btn-inline">Copy Key</button>
                        </div>
                    `;
                    messageDiv.className = 'hero-message success';
                    
                    // Hide form and bypass link
                    form.style.display = 'none';
                    if (bypassLink) bypassLink.style.display = 'none';
                    
                    // Display success toaster for 10 seconds
                    messageDiv.style.display = 'block';
                    
                    // After 10 seconds, hide the toaster
                    setTimeout(() => {
                        messageDiv.style.display = 'none';
                        
                        // Then simulate clicking the X button to close the terminal box
                        const closeButton = document.querySelector('.terminal-close');
                        if (closeButton) {
                            closeButton.click();
                        }
                    }, 10000); // 10 seconds
                } else {
                    messageDiv.textContent = data.message || 'An error occurred. Please try again.';
                    messageDiv.className = 'hero-message error';
                }
                messageDiv.style.display = 'block';
            } catch (error) {
                // This shouldn't happen with our local testing logic, but just in case
                console.error('Error:', error);
                messageDiv.textContent = 'An error occurred. Please try again.';
                messageDiv.className = 'hero-message error';
                messageDiv.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'GET EARLY ACCESS NOW';
            }
        }

        function copyAccessKeyInline(key) {
            navigator.clipboard.writeText(key).then(() => {
                const copyBtn = document.querySelector('.copy-btn-inline');
                copyBtn.textContent = 'Copied!';
                setTimeout(() => copyBtn.textContent = 'Copy Key', 2000);
            });
        }
        
        // Unlock content function
        function unlockContent() {
            // Add class to body for styling
            document.body.classList.add('content-unlocked');
            
            // Show gated content
            document.getElementById('gatedContent').style.display = 'block';
            
            // Show navigation elements
            document.querySelectorAll('.gated-content').forEach(el => {
                el.style.display = '';
            });
            
            // Move hero content to bottom-left
            const heroContent = document.getElementById('heroContent');
            const heroSection = document.querySelector('.hero');
            heroContent.classList.remove('center-bottom');
            heroContent.classList.add('bottom-left');
            
            // Change hero section alignment
            heroSection.style.alignItems = 'flex-end';
            heroSection.style.justifyContent = 'flex-start';
            
            // Store unlock state
            localStorage.setItem('contentUnlocked', 'true');
        }
        
        // Track terminal box state
        let terminalBoxClicks = 0;
        
        // Bypass email gate function
        function bypassEmailGate(e) {
            e.preventDefault();
            
            const terminalBox = document.querySelector('.terminal-box');
            const heroContent = document.getElementById('heroContent');
            
            terminalBoxClicks++;
            
            if (terminalBoxClicks === 1) {
                // First click: move to left and unlock content
                if (heroContent) {
                    heroContent.classList.remove('center-bottom');
                    heroContent.classList.add('bottom-left');
                }
                unlockContent();
            } else if (terminalBoxClicks >= 2) {
                // Second click: hide terminal box and rearrange content
                if (terminalBox) {
                    terminalBox.style.display = 'none';
                    
                    // Add class to hero content to adjust positioning
                    if (heroContent) {
                        heroContent.classList.add('terminal-hidden');
                        
                        // Move logo above tagline
                        const heroLogo = heroContent.querySelector('.hero-logo');
                        const heroTagline = heroContent.querySelector('.hero-tagline');
                        
                        if (heroLogo && heroTagline && heroTagline.parentNode) {
                            heroTagline.parentNode.insertBefore(heroLogo, heroTagline);
                        }
                    }
                }
            }
        }
        
        // Check if content was previously unlocked
        // Email input display handler
        function updateEmailDisplay(input) {
            const display = document.getElementById('emailDisplay');
            const value = input.value;
            
            if (value.includes('@')) {
                const [localPart, domainPart] = value.split('@');
                display.innerHTML = `<span class="email-local">${localPart}</span><span class="email-domain">@${domainPart}</span>`;
            } else {
                display.innerHTML = `<span class="email-local">${value}</span>`;
            }
            
            // Show/hide display based on input
            display.style.opacity = value ? '1' : '0';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            if (localStorage.getItem('contentUnlocked') === 'true') {
                unlockContent();
                // Set click counter to 1 since content is already unlocked and box is on the left
                terminalBoxClicks = 1;
            }
        });

        // Sticky Footer Bar functionality
        let footerBar = null;
        let heroSection = null;
        let isFooterBarVisible = false;
        let hasSubmittedEmail = false;
        let hasManuallyClosedFooter = false;
        let hasReturnedToTop = false;

        function initStickyFooterBar() {
            footerBar = document.getElementById('stickyFooterBar');
            heroSection = document.querySelector('.hero');
            
            // Check if email already submitted (from localStorage)
            hasSubmittedEmail = localStorage.getItem('earlyAccessSubmitted') === 'true';
            
            if (!footerBar || !heroSection) return;

            function handleScroll() {
                const heroBottom = heroSection.getBoundingClientRect().bottom;
                
                // Don't show if email has been submitted
                if (hasSubmittedEmail) return;
                
                // Check if user has returned to top after manually closing
                if (hasManuallyClosedFooter && heroBottom > window.innerHeight * 0.5) {
                    hasReturnedToTop = true;
                }
                
                // Reset manual close flag if user has returned to top and scrolled down again
                if (hasManuallyClosedFooter && hasReturnedToTop && heroBottom <= 0) {
                    hasManuallyClosedFooter = false;
                    hasReturnedToTop = false;
                }
                
                // Don't show if manually closed and haven't returned to top
                if (hasManuallyClosedFooter) return;
                
                // Show footer bar when scrolled past hero
                if (heroBottom <= 0 && !isFooterBarVisible) {
                    isFooterBarVisible = true;
                    footerBar.classList.add('visible');
                    document.body.classList.add('footer-bar-visible');
                } else if (heroBottom > 0 && isFooterBarVisible) {
                    isFooterBarVisible = false;
                    footerBar.classList.remove('visible');
                    document.body.classList.remove('footer-bar-visible');
                }
            }

            window.addEventListener('scroll', handleScroll);
            handleScroll(); // Check initial state

            // Footer email input with @ coloring
            const footerEmailInput = footerBar.querySelector('.footer-email-input');
            const footerEmailDisplay = footerBar.querySelector('.footer-email-display');
            const footerEmailLocal = footerEmailDisplay.querySelector('.footer-email-local');
            const footerEmailDomain = footerEmailDisplay.querySelector('.footer-email-domain');

            footerEmailInput.addEventListener('input', function(e) {
                const value = e.target.value;
                if (value.includes('@')) {
                    const [local, domain] = value.split('@');
                    footerEmailLocal.textContent = local;
                    footerEmailDomain.textContent = '@' + (domain || '');
                    footerEmailDisplay.style.opacity = '1';
                } else {
                    footerEmailLocal.textContent = value;
                    footerEmailDomain.textContent = '';
                    footerEmailDisplay.style.opacity = value ? '1' : '0';
                }
            });

            footerEmailInput.addEventListener('focus', function() {
                if (this.value) {
                    footerEmailDisplay.style.opacity = '1';
                }
            });

            footerEmailInput.addEventListener('blur', function() {
                if (!this.value) {
                    footerEmailDisplay.style.opacity = '0';
                }
            });
        }

        // Submit footer email form
        async function submitFooterEmail(e) {
            e.preventDefault();
            const form = e.target;
            const emailInput = form.querySelector('.footer-email-input');
            const submitBtn = form.querySelector('.footer-submit-btn');
            const email = emailInput.value;

            // Disable form during submission
            emailInput.disabled = true;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            try {
                // Simulate API call (replace with actual API endpoint)
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Mark as submitted
                localStorage.setItem('earlyAccessSubmitted', 'true');
                hasSubmittedEmail = true;
                
                // Hide footer bar
                isFooterBarVisible = false;
                footerBar.classList.remove('visible');
                document.body.classList.remove('footer-bar-visible');
                
                // Show success message
                submitBtn.textContent = 'Success!';
                submitBtn.style.background = '#10b981';
                
                // Also submit the main form if it exists
                const mainEmailInput = document.getElementById('heroEmailInput');
                if (mainEmailInput) {
                    mainEmailInput.value = email;
                    const mainForm = mainEmailInput.closest('form');
                    if (mainForm) {
                        mainForm.dispatchEvent(new Event('submit'));
                    }
                }
                
            } catch (error) {
                // Re-enable form on error
                emailInput.disabled = false;
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit';
                alert('An error occurred. Please try again.');
            }
        }

        // Close footer bar function
        function closeFooterBar() {
            isFooterBarVisible = false;
            hasManuallyClosedFooter = true;
            hasReturnedToTop = false;
            footerBar.classList.remove('visible');
            document.body.classList.remove('footer-bar-visible');
        }

        // Initialize sticky footer bar
        document.addEventListener('DOMContentLoaded', function() {
            initStickyFooterBar();
            
            // Debug: Press Ctrl+Shift+R to reset footer bar for testing
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                    e.preventDefault();
                    localStorage.removeItem('earlyAccessSubmitted');
                    hasSubmittedEmail = false;
                    hasManuallyClosedFooter = false;
                    hasReturnedToTop = false;
                    const footerBar = document.getElementById('stickyFooterBar');
                    if (footerBar) {
                        footerBar.classList.remove('hidden');
                        // Trigger scroll check to show if needed
                        const heroSection = document.querySelector('.hero');
                        if (heroSection && heroSection.getBoundingClientRect().bottom <= 0) {
                            footerBar.classList.add('visible');
                            document.body.classList.add('footer-bar-visible');
                            isFooterBarVisible = true;
                        }
                    }
                    console.log('Footer bar reset for testing');
                    
                    // Show a temporary notification
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #32feff;
                        color: #000;
                        padding: 1rem 2rem;
                        font-family: 'Orbitron', monospace;
                        font-size: 0.875rem;
                        font-weight: 600;
                        text-transform: uppercase;
                        letter-spacing: 0.1em;
                        z-index: 10000;
                        animation: slideIn 0.3s ease;
                    `;
                    notification.textContent = 'Footer Bar Reset';
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.animation = 'slideOut 0.3s ease';
                        setTimeout(() => notification.remove(), 300);
                    }, 2000);
                }
            });
        });

        // Mouse spotlight effect
        const mouseSpotlight = document.querySelector('.mouse-spotlight');
        
        // Detect if the device is iPadOS/iPad
        function isIPadOS() {
            return navigator.maxTouchPoints && 
                   navigator.maxTouchPoints > 2 && 
                   /MacIntel/.test(navigator.platform);
        }
        
        // Detect if it's a tablet (including Android tablets)
        function isTablet() {
            const userAgent = navigator.userAgent.toLowerCase();
            const isIPad = isIPadOS() || /ipad/.test(userAgent);
            const isAndroidTablet = /android/.test(userAgent) && !/mobile/.test(userAgent);
            const isSurfaceTablet = /windows nt/.test(userAgent) && /touch/.test(userAgent);
            
            return isIPad || isAndroidTablet || isSurfaceTablet;
        }
        
        // Only enable mouse spotlight on desktop devices
        if (!isTablet()) {
            let spotlightX = 0;
            let spotlightY = 0;
            let spotlightCurrentX = 0;
            let spotlightCurrentY = 0;
            let isSpotlightMoving = false;
            let spotlightFadeTimeout;

            document.addEventListener('mousemove', (e) => {
                spotlightX = e.clientX;
                spotlightY = e.clientY;
                
                // Show spotlight when mouse moves
                if (!isSpotlightMoving) {
                    isSpotlightMoving = true;
                    mouseSpotlight.style.opacity = '1';
                }
                
                // Clear existing timeout
                clearTimeout(spotlightFadeTimeout);
                
                // Hide spotlight after mouse stops
                spotlightFadeTimeout = setTimeout(() => {
                    mouseSpotlight.style.opacity = '0';
                    isSpotlightMoving = false;
                }, 1000);
            });

            // Smooth animation loop
            function animateSpotlight() {
                // Smooth interpolation
                spotlightCurrentX += (spotlightX - spotlightCurrentX) * 0.1;
                spotlightCurrentY += (spotlightY - spotlightCurrentY) * 0.1;
                
                mouseSpotlight.style.left = spotlightCurrentX + 'px';
                mouseSpotlight.style.top = spotlightCurrentY + 'px';
                
                requestAnimationFrame(animateSpotlight);
            }
            
            animateSpotlight();

            // Hide spotlight when mouse leaves window
            document.addEventListener('mouseleave', () => {
                mouseSpotlight.style.opacity = '0';
                isSpotlightMoving = false;
            });
        } else {
            // Hide spotlight element on tablets
            if (mouseSpotlight) {
                mouseSpotlight.style.display = 'none';
            }
        }

        // Legacy Modal Functions (keeping for compatibility)
        function openEarlyAccessModal() {
            document.getElementById('earlyAccessModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeEarlyAccessModal() {
            document.getElementById('earlyAccessModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        async function submitEarlyAccess(e) {
            e.preventDefault();
            const email = document.getElementById('earlyAccessEmail').value;
            const submitBtn = document.getElementById('submitEarlyAccess');
            const errorMsg = document.getElementById('errorMessage');
            const successMsg = document.getElementById('successMessage');
            const formContainer = document.getElementById('formContainer');
            
            // Clear previous messages
            errorMsg.style.display = 'none';
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            try {
                const response = await fetch('/api/early-access', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Show success message with key
                    formContainer.style.display = 'none';
                    successMsg.style.display = 'block';
                    document.getElementById('accessKey').textContent = data.key || 'STAR-ATLAS-KEY-XXXX';
                } else {
                    errorMsg.textContent = data.message || 'An error occurred. Please try again.';
                    errorMsg.style.display = 'block';
                }
            } catch (error) {
                errorMsg.textContent = 'Connection error. Please try again.';
                errorMsg.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Get Access Now';
            }
        }

        function copyAccessKey() {
            const key = document.getElementById('accessKey').textContent;
            navigator.clipboard.writeText(key).then(() => {
                const copyBtn = document.querySelector('.copy-btn');
                copyBtn.textContent = 'Copied!';
                setTimeout(() => copyBtn.textContent = 'Copy', 2000);
            });
        }

        // Close modal on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('earlyAccessModal');
            if (event.target === modal) {
                closeEarlyAccessModal();
            }
        }

        // Community section character parallax animations
        document.addEventListener('DOMContentLoaded', function() {
            const communitySection = document.querySelector('.community-section');
            const communityChars = document.querySelectorAll('.community-char');
            
            if (communitySection && communityChars.length > 0) {
                // Remove the initial animation and set initial state
                communityChars.forEach(char => {
                    // Add a small transition to smooth out any jumps
                    char.style.transition = 'transform 0.1s ease-out';
                    char.style.opacity = '1';
                    
                    // Set different starting positions for each character
                    if (char.classList.contains('char-mid')) {
                        char.style.transform = 'translateY(150px)';
                    } else if (char.classList.contains('char-left')) {
                        char.style.transform = 'translateY(120px)';
                    } else if (char.classList.contains('char-right')) {
                        char.style.transform = 'translateY(60px)'; // 90px - 30px offset
                    }
                });
                
                function updateCharacterPositions() {
                    const sectionRect = communitySection.getBoundingClientRect();
                    const windowHeight = window.innerHeight;
                    
                    // Get section dimensions
                    const sectionTop = sectionRect.top;
                    const sectionBottom = sectionRect.bottom;
                    const sectionHeight = sectionRect.height;
                    
                    // Start much earlier - when section bottom is 600px below viewport
                    const startPoint = windowHeight + 600;
                    // Complete when section bottom is 200px into the viewport
                    const endPoint = windowHeight - 200;
                    
                    // Calculate progress based on section bottom position
                    let progress = 1 - ((sectionBottom - endPoint) / (startPoint - endPoint));
                    progress = Math.max(0, Math.min(1, progress));
                    
                    // Apply a very smooth easing curve (ease-in-out cubic)
                    const easedProgress = progress < 0.5
                        ? 4 * progress * progress * progress
                        : 1 - Math.pow(-2 * progress + 2, 3) / 2;
                    
                    // Update character positions with different rates
                    communityChars.forEach((char, index) => {
                        let translateDistance;
                        let speedMultiplier;
                        let finalOffset = 0;
                        
                        // Different rates and final positions for each character
                        if (char.classList.contains('char-mid')) {
                            // Middle character - fastest (moves the full 150px)
                            speedMultiplier = 1.0;
                            translateDistance = 150;
                            finalOffset = 0; // Ends at base position
                        } else if (char.classList.contains('char-left')) {
                            // Left character - second fastest (moves 120px)
                            speedMultiplier = 0.8;
                            translateDistance = 120;
                            finalOffset = 0; // Ends at base position
                        } else if (char.classList.contains('char-right')) {
                            // Right character - slowest (moves 90px but ends higher)
                            speedMultiplier = 0.6;
                            translateDistance = 90;
                            finalOffset = -30; // Ends 30px higher to compensate
                        }
                        
                        // Apply different speed to progress
                        const adjustedProgress = Math.max(0, Math.min(1, easedProgress * speedMultiplier));
                        const translateY = translateDistance * (1 - adjustedProgress) + finalOffset;
                        
                        char.style.transform = `translateY(${translateY}px)`;
                    });
                }
                
                // Initial position update
                updateCharacterPositions();
                
                // Update on scroll with throttling
                let scrollTimeout;
                window.addEventListener('scroll', () => {
                    if (!scrollTimeout) {
                        scrollTimeout = requestAnimationFrame(() => {
                            updateCharacterPositions();
                            scrollTimeout = null;
                        });
                    }
                });
                
                // Also update on resize
                window.addEventListener('resize', updateCharacterPositions);
            }
        });

        // Ensure hero video autoplay on mobile
        document.addEventListener('DOMContentLoaded', function() {
            const heroVideo = document.querySelector('.video-background');
            
            if (heroVideo) {
                // Force video to play on mobile devices
                const playVideo = () => {
                    heroVideo.play().catch(e => {
                        console.log('Video autoplay prevented:', e);
                        // Try playing on user interaction if autoplay fails
                        document.addEventListener('touchstart', () => {
                            heroVideo.play().catch(() => {});
                        }, { once: true });
                    });
                };
                
                // Play video when it's ready
                if (heroVideo.readyState >= 3) {
                    playVideo();
                } else {
                    heroVideo.addEventListener('loadeddata', playVideo, { once: true });
                }
                
                // Ensure video keeps looping
                heroVideo.addEventListener('ended', () => {
                    heroVideo.currentTime = 0;
                    heroVideo.play().catch(() => {});
                });
                
                // Handle visibility changes (when user switches tabs)
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden && heroVideo.paused) {
                        heroVideo.play().catch(() => {});
                    }
                });
            }
        });

        // Pixel Effect Implementation for Stat Cards
        class Pixel {
            constructor(canvas, context, x, y, color, speed, delay, distanceRatio, pixelSize = 3) {
                this.width = canvas.width
                this.height = canvas.height
                this.ctx = context
                this.x = x
                this.y = y
                this.color = color
                this.speed = this.getRandomValue(0.1, 0.9) * speed
                this.size = 0
                this.sizeStep = Math.random() * 0.4
                this.minSize = 0.5
                
                // Apply vignetting - smaller max size near edges
                const vignetteScale = 1 - Math.pow(distanceRatio, 2) * 0.6 // Quadratic falloff
                this.maxSizeInteger = pixelSize * vignetteScale  // Use custom pixel size
                this.maxSize = this.getRandomValue(this.minSize, Math.max(this.minSize, this.maxSizeInteger))
                
                this.delay = delay
                this.counter = 0
                this.counterStep = Math.random() * 2 + 3  // Reduced randomness for more uniform reveal
                this.isIdle = false
                this.isReverse = false
                this.isShimmer = false
                this.distanceRatio = distanceRatio
            }

            getRandomValue(min, max) {
                return Math.random() * (max - min) + min
            }

            draw() {
                const centerOffset = this.maxSizeInteger * 0.5 - this.size * 0.5
                
                // Apply vignetting to opacity
                this.ctx.save()
                const vignetteOpacity = 1 - Math.pow(this.distanceRatio, 1.5) * 0.7
                this.ctx.globalAlpha = this.ctx.globalAlpha * vignetteOpacity
                
                this.ctx.fillStyle = this.color
                this.ctx.fillRect(
                    this.x + centerOffset,
                    this.y + centerOffset,
                    this.size,
                    this.size
                )
                
                this.ctx.restore()
            }

            appear() {
                this.isIdle = false

                if (this.counter <= this.delay) {
                    this.counter += this.counterStep
                    return
                }

                if (this.size >= this.maxSize) {
                    this.isShimmer = true
                }

                if (this.isShimmer) {
                    this.shimmer()
                } else {
                    this.size += this.sizeStep
                }

                this.draw()
            }

            disappear() {
                this.isShimmer = false
                this.counter = 0

                if (this.size <= 0) {
                    this.isIdle = true
                    return
                } else {
                    this.size -= 0.1
                }

                this.draw()
            }

            shimmer() {
                if (this.size >= this.maxSize) {
                    this.isReverse = true
                } else if (this.size <= this.minSize) {
                    this.isReverse = false
                }

                if (this.isReverse) {
                    this.size -= this.speed
                } else {
                    this.size += this.speed
                }
            }
        }

        // Define the pixel canvas web component
        class PixelCanvasElement extends HTMLElement {
            constructor() {
                super()
                this.canvas = document.createElement("canvas")
                this.ctx = this.canvas.getContext("2d")
                this.pixels = []
                this.animation = null
                this.timeInterval = 1000 / 60
                this.timePrevious = performance.now()
                this.reducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches
                this._initialized = false
                this._resizeObserver = null
                this._parent = null

                const shadow = this.attachShadow({ mode: "open" })
                const style = document.createElement("style")
                style.textContent = `
                    :host {
                        display: grid;
                        inline-size: 100%;
                        block-size: 100%;
                        overflow: hidden;
                    }
                `
                shadow.appendChild(style)
                shadow.appendChild(this.canvas)
            }

            get colors() {
                return this.dataset.colors?.split(",") || ["#32feff", "#ffffff", "#7dd3fc"]
            }

            get gap() {
                const value = Number(this.dataset.gap) || 5
                return Math.max(4, Math.min(50, value))
            }

            get speed() {
                const value = Number(this.dataset.speed) || 35
                return this.reducedMotion ? 0 : Math.max(0, Math.min(100, value)) * 0.001
            }

            get variant() {
                return this.dataset.variant || "default"
            }

            get opacity() {
                const value = Number(this.dataset.opacity)
                return isNaN(value) ? 1 : Math.max(0, Math.min(1, value))
            }

            get blend() {
                return this.dataset.blend || "normal"
            }

            get pixelSize() {
                const value = Number(this.dataset.size)
                return isNaN(value) ? 3 : Math.max(1, Math.min(10, value))
            }

            connectedCallback() {
                if (this._initialized) return
                this._initialized = true
                this._parent = this.parentElement

                requestAnimationFrame(() => {
                    this.handleResize()

                    const ro = new ResizeObserver((entries) => {
                        if (!entries.length) return
                        requestAnimationFrame(() => this.handleResize())
                    })
                    ro.observe(this)
                    this._resizeObserver = ro
                })

                this._parent?.addEventListener("mouseenter", () => this.handleAnimation("appear"))
                this._parent?.addEventListener("mouseleave", () => this.handleAnimation("disappear"))
            }

            disconnectedCallback() {
                this._initialized = false
                this._resizeObserver?.disconnect()

                if (this.animation) {
                    cancelAnimationFrame(this.animation)
                    this.animation = null
                }

                this._parent = null
            }

            handleResize() {
                if (!this.ctx || !this._initialized) return

                const rect = this.getBoundingClientRect()
                if (rect.width === 0 || rect.height === 0) return

                const width = Math.floor(rect.width)
                const height = Math.floor(rect.height)

                const dpr = window.devicePixelRatio || 1
                this.canvas.width = width * dpr
                this.canvas.height = height * dpr
                this.canvas.style.width = `${width}px`
                this.canvas.style.height = `${height}px`

                this.ctx.setTransform(1, 0, 0, 1, 0, 0)
                this.ctx.scale(dpr, dpr)

                this.createPixels()
            }

            getDistanceToCenter(x, y) {
                // Use CSS dimensions for proper center calculation
                const rect = this.getBoundingClientRect()
                const centerX = rect.width / 2
                const centerY = rect.height / 2
                const dx = x - centerX
                const dy = y - centerY
                return Math.sqrt(dx * dx + dy * dy)
            }

            createPixels() {
                if (!this.ctx) return
                this.pixels = []

                // Get actual element dimensions for proper center calculation
                const rect = this.getBoundingClientRect()
                const width = rect.width
                const height = rect.height

                // Calculate max distance for normalization
                const maxDistance = Math.sqrt(
                    Math.pow(width / 2, 2) + 
                    Math.pow(height / 2, 2)
                )

                // Create pixels based on CSS dimensions, not canvas dimensions
                for (let x = 0; x < width; x += this.gap) {
                    for (let y = 0; y < height; y += this.gap) {
                        const color = this.colors[Math.floor(Math.random() * this.colors.length)]
                        // Enhanced delay calculation for clearer radial effect
                        let delay = 0
                        const distance = this.getDistanceToCenter(x, y)
                        const distanceRatio = distance / maxDistance
                        
                        if (!this.reducedMotion && this.variant === 'icon') {
                            // Normalize and scale the delay for more visible radial pattern
                            delay = distanceRatio * 200  // Increased from 150 to slow down
                        }

                        this.pixels.push(
                            new Pixel(this.canvas, this.ctx, x, y, color, this.speed, delay, distanceRatio, this.pixelSize)
                        )
                    }
                }
            }

            handleAnimation(name) {
                if (this.animation) {
                    cancelAnimationFrame(this.animation)
                }

                const animate = () => {
                    this.animation = requestAnimationFrame(animate)

                    const timeNow = performance.now()
                    const timePassed = timeNow - this.timePrevious

                    if (timePassed < this.timeInterval) return

                    this.timePrevious = timeNow - (timePassed % this.timeInterval)

                    if (!this.ctx) return
                    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)
                    
                    // Apply global opacity for dimmer effect
                    this.ctx.save()
                    this.ctx.globalAlpha = this.opacity
                    
                    // Apply blend mode if specified
                    if (this.blend === 'additive') {
                        this.ctx.globalCompositeOperation = 'overlay'
                    }

                    let allIdle = true
                    for (const pixel of this.pixels) {
                        pixel[name]()
                        if (!pixel.isIdle) allIdle = false
                    }
                    
                    this.ctx.restore()

                    if (allIdle) {
                        cancelAnimationFrame(this.animation)
                        this.animation = null
                    }
                }

                animate()
            }
        }

        // Register the web component
        if (!customElements.get("pixel-canvas")) {
            customElements.define("pixel-canvas", PixelCanvasElement)
        }
    </script>

    <!-- Early Access Modal -->
    <div id="earlyAccessModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEarlyAccessModal()">&times;</span>
            
            <div id="formContainer">
                <h2>Get Early Access</h2>
                <p>Enter your email to receive your early access key</p>
                
                <form onsubmit="submitEarlyAccess(event)" class="modal-form">
                    <input 
                        type="email" 
                        id="earlyAccessEmail" 
                        placeholder="Enter your email" 
                        required
                        class="modal-input"
                    />
                    
                    <p class="disclaimer">
                        By entering your email, you'll get your early-access key and occasional updates from Star Atlas. You can unsubscribe anytime.
                    </p>
                    
                    <button type="submit" id="submitEarlyAccess" class="modal-submit">Get Access Now</button>
                </form>
                
                <div id="errorMessage" class="error-message" style="display: none;"></div>
            </div>
            
            <div id="successMessage" class="success-container" style="display: none;">
                <h2>Success!</h2>
                <p>Your early access key:</p>
                <div class="key-display">
                    <span id="accessKey"></span>
                    <button onclick="copyAccessKey()" class="copy-btn">Copy</button>
                </div>
                <p class="success-note">Check your email for instructions on how to use your key.</p>
            </div>
        </div>
    </div>
</body>
</html> 